
@{
    ViewData["Header"] = "Header";
    var email = Context.Request.Cookies["UserEmail"];
    string displayName = "KhÃ¡ch";

    if (!string.IsNullOrEmpty(email))
    {
        var db = Context.RequestServices
                        .GetService(typeof(AppDbContext)) as AppDbContext;

        var user = db?.Customers.FirstOrDefault(x => x.Email == email);
        if (user != null)
        {
            displayName = user.FullName;
        }
    }
}


<div class="header-wrapper">

    <div class="header-left">
        <a href="/" class="logo">SHOP New</a>
    </div>

<div class="search-box">
    <form asp-controller="Home" asp-action="Search" method="get">
        <input type="text" id="searchInput" name="keyword" placeholder="TÃ¬m sáº£n pháº©m..." autocomplete="off" />
        <button type="submit" class="search-btn">TÃ¬m</button>
    </form>

    <ul id="suggestList" class="suggest-box"></ul>
</div>

<div class="header-right">

    @if (displayName == "KhÃ¡ch")
    {
        <a asp-controller="Account" asp-action="Login">ÄÄƒng nháº­p</a>
    }
    else
    {
        <span class="user-name">
            ChÃ o má»«ng <br /> ğŸ‘¤ @displayName
        </span>
    }

    <a asp-controller="Cart" asp-action="Index">Giá» hÃ ng ğŸ›’</a>
    <button class="menu-btn" onclick="openMenu()">â˜°</button>

</div>
</div>

<div id="sideMenu" class="side-menu">
    <div class="side-menu-header">
        <img src="~/Img/default-avatar.jpg" class="avatar" />
        <p class="username">
            <p class="username">@displayName</p>
        </p>
    </div>

    <ul class="side-menu-list">
        <li onclick="comingSoon()">
            ğŸ‘¤ Há»“ sÆ¡ ngÆ°á»i dÃ¹ng
        </li>
        <li onclick="comingSoon()">
            ğŸ“¦ Xem Ä‘Æ¡n hÃ ng
        </li>
        <li>
            <a asp-controller="Account" asp-action="Logout" class="logout-btn">
                ğŸšª ÄÄƒng xuáº¥t
            </a>
        </li>
    </ul>
</div>
<script>
document.getElementById("searchInput").addEventListener("keyup", function () {
    let keyword = this.value;

    if (keyword.length < 1) {
        document.getElementById("suggestList").innerHTML = "";
        return;
    }

    fetch(`/Home/SearchSuggest?keyword=${keyword}`)
        .then(res => res.json())
        .then(data => {
            let html = "";
            data.forEach(item => {
                html += `<li onclick="selectSuggest('${item}')">${item}</li>`;
            });
            document.getElementById("suggestList").innerHTML = html;
        });
});

function selectSuggest(text) {
    document.getElementById("searchInput").value = text;
    document.getElementById("suggestList").innerHTML = "";
}
</script>